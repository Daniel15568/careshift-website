<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Shifts - CareShiftAI</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header>
    <h1>My Shifts</h1>
    <nav>
      <a href="/">Home</a>
      <a href="/dashboard">Dashboard</a>
      <a href="/open-shifts">Find extra work</a>
      <a href="/profile-documents">Profile &amp; documents</a>
      <a href="/logout">Logout</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Hello, <%= user.name %></h2>
      <p>This page shows all shifts assigned to you.</p>
    </section>

    <% if (error) { %>
      <div class="error"><%= error %></div>
    <% } %>

    <section>
      <% if (shifts.length === 0) { %>
        <p>You donâ€™t have any shifts yet.</p>
      <% } else { %>
        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Start</th>
              <th>End</th>
              <th>Location</th>
              <th>Role</th>
              <th>Notes</th>
              <th>Status</th>
               <th>Attendance</th>
            </tr>
          </thead>
              <tbody>
    <% if (shifts && shifts.length) { %>
      <% shifts.forEach(shift => { %>
        <tr>
          <!-- Match the headers, one <td> per <th> -->
          <td><%= shift.date %></td>
          <td><%= shift.start_time %></td>
          <td><%= shift.end_time %></td>
          <td><%= shift.location %></td>

          <!-- Role column: JUST the role text -->
          <td><%= shift.role %></td>

          <!-- Notes column (use whatever you called it) -->
          <td><%= shift.notes || '' %></td>

          <!-- Status column -->
          <td><%= shift.status || '' %></td>

          <!-- Attendance column: clock in/out buttons + times -->
          <td>
            <% if (!shift.clock_in) { %>
              <!-- Not clocked in yet -->
              <form method="POST"
                    action="/shifts/<%= shift.id %>/clock-in"
                    style="display:inline;">
                <button type="submit" class="btn-primary-small">Clock in</button>
              </form>
            <% } else if (shift.clock_in && !shift.clock_out) { %>
              <!-- Clocked in but not out yet -->
              <div class="small-text">
                Clocked in at:
                <%= new Date(shift.clock_in).toLocaleTimeString([], {
                  hour: '2-digit',
                  minute: '2-digit'
                }) %>
              </div>
              <form method="POST"
                    action="/shifts/<%= shift.id %>/clock-out"
                    style="display:inline;">
                <button type="submit" class="btn-secondary-small">Clock out</button>
              </form>
            <% } else { %>
              <!-- Fully completed -->
              <div class="small-text">
                In:
                <%= new Date(shift.clock_in).toLocaleTimeString([], {
                  hour: '2-digit',
                  minute: '2-digit'
                }) %><br />
                Out:
                <%= new Date(shift.clock_out).toLocaleTimeString([], {
                  hour: '2-digit',
                  minute: '2-digit'
                }) %>
              </div>
            <% } %>
          </td>
        </tr>
      <% }); %>
    <% } else { %>
      <tr>
        <td colspan="8">No shifts assigned yet.</td>
      </tr>
    <% } %>
  </tbody>

        </table>
      <% } %>
    </section>
  </main>

  <footer>
    <p>&copy; <%= new Date().getFullYear() %> CareShiftAI</p>
  </footer>
</body>
</html>
